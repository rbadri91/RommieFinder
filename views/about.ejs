<!doctype html>
<html lang="en" class="no-js">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="/stylesheets/pageLayout.css">
	<script src="http://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.1/themes/smoothness/jquery-ui.css" />
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<script type="text/plain" src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
</head>

<!-- <div class="popupWrapper">
<div class="popup" data-popup="popup-1" style ="z-index: 20">
    <div class="popup-inner">
      <div id = "loadContents"></div>
      <br>
      <br>
        <a id="closepopUp" class="popup-close" data-popup1-close="popup-1" href="#">x</a>
    </div>
</div>
</div> -->

<body>
<h2 class="text-center center-block">About Me</h2>
<hr>
<div class="profileWrapper text-center center-block">
<input type="image" id="profimage"/>
 <p class="profileDesc">Change Profile</p>
</div>
<div class= "row" id="aboutContent"><%= about %></div>
 <textarea style="font-family:sans-serif;width:70%; height:60%; overflow: hidden;display: none" id ="aboutMe" name="aboutMe" onkeyup="auto_grow(this)"></textarea>
<br><br>
<button class= "btn btn-primary btn-sm center-block" id ="updateDiv" onclick="updateContent()">Update</button>
<button class= "btn btn-primary btn-sm center-block" id ="saveContent" onclick="saveAboutContent()" style="display: none">Save</button>
<button class= "btn btn-primary btn-sm center-block" id ="cancel" onclick="cancelUpdate()" style="display: none">Cancel</button>
</body>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.ns-autogrow/1.1.6/jquery.ns-autogrow.js"></script> -->
<script src ="https://cdn.jsdelivr.net/g/jquery.menu-aim@0.1,jquery.autogrow@1.2.2"></script>

<script>
var aboutMe = document.getElementById("aboutMe");
var saveContent = document.getElementById("saveContent");
var cancel = document.getElementById("cancel");
var aboutContentDiv = document.getElementById("aboutContent");
var updateDiv = document.getElementById("updateDiv");

$(function(){
	var profileImagesrc = <%-JSON.stringify(profilesrc)%>
		document.getElementById("profimage").src=profileImagesrc ;
});
	 function updateContent(){
	 	var aboutContent = document.getElementById("aboutContent").textContent;
	 	if(aboutMe.style.display == "none"){
	 		aboutMe.style.display = "block";
	 		updateDiv.style.display ="none";
	 		aboutMe.value =aboutContent;
	 		saveContent.style.display = "inline";
	 		cancel.style.display = "inline";
	 		aboutContentDiv.style.display ="none";
	 	}else{
	 		aboutMe.style.display = "none";
	 		aboutMe.value ="";
	 		saveContent.style.display = "none";
	 		cancel.style.display = "none";
	 		updateDiv.style.display ="block";
	 		aboutContentDiv.style.display ="block";
	 	}
	 }

	 function saveAboutContent(){
	 	var aboutMeContent = document.getElementById("aboutMe").value;
	 	console.log("it comes here:",aboutMeContent);
	 	// aboutMe.style.display = "none";
	 	// aboutMe.value ="";
	 	$.post( "/saveAboutMe", {aboutUpdate:aboutMeContent},function( data ) {
		 console.log("saved");
	 		// saveContent.style.display = "none";
	 		// cancel.style.display = "none";
	 		aboutContentDiv.textContent = aboutMeContent;
	 		// aboutContentDiv.style.display ="block";
	 		// updateDiv.style.display ="block";
	 		cancelUpdate();
		});
	 }

	 function cancelUpdate(){
	 		aboutMe.style.display = "none";
	 		aboutMe.value ="";
	 		saveContent.style.display = "none";
	 		cancel.style.display = "none";
	 		aboutContentDiv.style.display ="block";
	 		updateDiv.style.display ="block";
	 }

	 function auto_grow(element) {
	    element.style.height = "5px";
	    element.style.height = (element.scrollHeight)+"px";
	}
</script>
</html>